<!DOCTYPE html>
<html>
<head>
	<title>Wordpress Toolbar for Safari</title>
	<script type="text/javascript" charset="utf-8">

	function performCommand(event) {
		if (event.command === "button") {
			var currentURL = event.target.browserWindow.activeTab.url;
			if (currentURL)
				// console.log("showing");
				safari.application.activeBrowserWindow.activeTab.page.dispatchMessage("show toolbar", true);
		}
	}
	 
	function validateCommand(event) {
		if (event.command === "button") {
			// Disable the button if there is no URL loaded in the tab.
			event.target.disabled = !event.target.browserWindow.activeTab.url;	
		}
	}
	
	// Register event listeners
	safari.application.addEventListener("command", performCommand, false);
	safari.application.addEventListener("validate", validateCommand, false);

	</script>
</head>
<body>
</body>
</html>